While researching the security standpoint of GOG Galaxy (`v2.0.71.2`, also tested in `v2.0.68.112` and `v2.0.67.2`), we noticed that the application is writing log files into the `C:\ProgramData\GOG.com\Galaxy\logs` folder over which the `Users` group has read, write and execute Permissions. 

This kind of behavior can be abused by leveraging file system manipulation techniques that imply creating an NTFS junction and then the equivalent of a symbolic link to write into any other file the attacker would like to corrupt. As the log files are written to by the `GalaxyClientService.exe` privileged process that runs as `NT/AUTHORITY SYSTEM`, the attacker can redirect the write operation to files within the `C:\Windows\System32` directory.

It should be noted that the content of what is written into the target file cannot be controlled, which makes elevating privileges tricky, if not impossible. This issue can still be abused to perform a permanent Denial-of-Service (DoS) against the target host by overriding critical system files, such as `C:\Windows\System32\drivers\pci.sys` for example. Once that file is overwritten, the target host becomes unable to boot.

We created a Proof-of-Concept Windows PowerShell Script that automatically exploits this vulnerability. Please refer to the attached set of directories to find it, labeled as `GOG_Galaxy_Arbitrary_File_Overwrite_PoC.ps1`, or copy the contents of the Exploit Source Code from the `poc/` directory to a new file.

Running our PoC will damage the underlying host, and as such, we recommend running it in a fresh Virtual Machine only used for testing that does not contain any personal or sensitive data:

1. Open a new PowerShell Terminal Session on a Windows Host that has GOG Galaxy installed.

2. Run the PS1 Exploit file by executing the following command: `.\PATH\TO\FILE\GOG_Galaxy_Arbitrary_File_Overwrite_PoC.ps1`

3. Wait for you Host machine to be rebooted and the Windows Agent to Attempt Repairs before providing a diagnostic.

You should be able to observe that the DACL of GOG Galaxy's `logs/` main directory gives the `Users` group read, write and execute permissions by right clicking on that folder and selecting `Properties > Security`.

For further reference, feel free to look at the demonstration Proof-of-Concept video stored in the `demo/` subdirectory.
